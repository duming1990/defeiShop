(function(i){var h={},o={},d,b,f=750,m=250,l;if(!i.fn.on){i.fn.on=function(p,q){return this.bind(p,q)}}i.getPosition=function(q){if(q.type.substr(0,5)=="touch"){var p=q.originalEvent;var r=p.changedTouches[0]}else{var r=q}return{x:r.clientX,y:r.clientY}};i.getTouch=function(){return h};function j(q,p,s,r){return Math.abs(q-p)>=Math.abs(s-r)?(q-p>0?"Left":"Right"):(s-r>0?"Up":"Down")}function n(){b=null;if(h.last){h.el.trigger("longTap",[h]);h={}}}function e(){if(b){clearTimeout(b)}b=null}function g(q){var p=a("tapCancel",q);if(h.el){h.el.trigger(p,[h])}else{i(document).trigger(p,[h])}if(p.result===false){return}if(d){clearTimeout(d)}if(b){clearTimeout(b)}d=b=null;h={}}function k(p){return(p.pointerType=="touch"||p.pointerType==p.MSPOINTER_TYPE_TOUCH)&&p.isPrimary}function c(q,p){return(q.type=="pointer"+p||q.type.toLowerCase()=="mspointer"+p)}function a(q,r){var p=i.Event(q);p.parentEvent=r;return p}i(document).ready(function(){var r,s,q=0,p=0;if("MSGesture" in window){l=new MSGesture();l.target=document.body}i(document).bind("MSGestureEnd",function(t){var v=t.originalEvent;var u=v.velocityX>1?"Right":v.velocityX<-1?"Left":v.velocityY>1?"Down":v.velocityY<-1?"Up":null;if(u){h.el.trigger("swipe",[h]);h.el.trigger("swipe"+u,[h])}}).on("touchstart MSPointerDown pointerdown mousedown",function(u){var w=u.originalEvent,t=c(w,"down");if(t&&!k(w)){return}var v=w.type=="touchstart"?w.touches[0]:u;if(w.touches&&w.touches.length===1&&h.x2){h.x2=undefined;h.y2=undefined}r=Date.now();s=r-(o.last||r);h.el=i(v.target);d&&clearTimeout(d);h.x1=v.clientX;h.y1=v.clientY;if(s>0&&s<=m){h.isDoubleTap=true}h.last=r;b=setTimeout(n,f);if(l&&t){l.addPointer(w.pointerId)}h.el.trigger(a("tapStart",u),[h])}).on("touchmove MSPointerMove pointermove mousemove",function(u){if(!h.last){return}var w=u.originalEvent,t=c(w,"move");if(t&&!k(w)){return}var v=w.type=="touchmove"?w.touches[0]:u;e();h.x2=v.clientX;h.y2=v.clientY;q+=Math.abs(h.x1-h.x2);p+=Math.abs(h.y1-h.y2);h.el.trigger(a("tapMove",u),[h])}).on("touchend MSPointerUp pointerup mouseup",function(v){if(!h.last){return}o=h,h={};o.el.trigger(a("tapEnd",v),[o]);var w=v.originalEvent,u=c(w,"up");if(u&&!k(w)){return}e();if((o.x2&&Math.abs(o.x1-o.x2)>30)||(o.y2&&Math.abs(o.y1-o.y2)>30)){o.el.trigger("swipe",[o]);o.el.trigger("swipe"+(j(o.x1,o.x2,o.y1,o.y2)),[o])}else{if("last" in o){if(q<30&&p<30){var t=a("tap",v);t.cancelTouch=g;o.el.trigger(t,[o]);if(o.isDoubleTap){if(o.el){o.el.trigger("doubleTap",[o])}}else{d=setTimeout(function(){d=null;if(o.el){o.el.trigger("singleTap",[o])}o={}},m)}}}}q=p=0}).on("touchcancel MSPointerCancel pointercancel",g);i(window).on("scroll",g)});["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap","tapStart","tapMove","tapEnd","tapCancel"].forEach(function(p){i.fn[p]=function(q){return this.on(p,q)}})})(jQuery);
